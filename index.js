var x$;x$=angular.module("main",["firebase"]),x$.controller("main",["$scope","$firebaseArray"].concat(function(n,r){var o,t,e,c,a,l,d,i;return o=new Firebase("https://aidraw.firebaseio.com/points"),t=r(o),t.$watch(function(){return i()}),e=[1024,600,60],c=e[0],a=e[1],l=e[2],n.chosen=null,n.nodes=t,n.remove=function(){return"number"==typeof n.chosen&&n.chosen<n.nodes.length?(n.nodes.$remove(n.chosen),n.chosen=void 0):n.nodes.$remove(0),i()},n.random=function(){return d(),i()},d=function(r){var o;return o={},o.anchor="undefined"!=typeof r?[l+(c-2*l)*(r%2),l+50*r]:[Math.random()*(c-2*l)+l,Math.random()*(a-2*l)+l],o.ctrl1=[100*Math.random()-50,100*Math.random()-50],o.ctrl2=[100*Math.random()-50,100*Math.random()-50],n.nodes.$add(o)},i=function(){var r,o,t,e,c,a,l,d,i,s;if(0!==n.nodes.length){for(r="M"+n.nodes[0].anchor[0]+" "+n.nodes[0].anchor[1],o=n.nodes[0],t=1,e=n.nodes.length;e>t;++t)c=t,a=n.nodes[c],l=o.anchor[0]+o.ctrl2[0],d=o.anchor[1]+o.ctrl2[1],i=a.anchor[0]+a.ctrl1[0],s=a.anchor[1]+a.ctrl1[1],r+="C"+l+" "+d+" "+i+" "+s+" "+a.anchor[0]+" "+a.anchor[1],o=a;return n.path=r}},n.$watch("nodes",function(){return i()}),n.ptrctrl={down:function(r){var o,t,e;for(o=$(r.target),(o.attr("class")||"").split(" ").indexOf("ctrl")>=0&&(n.ctrl=o.attr("ctrl"));o&&!o.attr("idx")&&(o=$(o.parent()),"BODY"!==(t=o[0].nodeName)&&"SVG"!==t););return(e=o.attr("idx"))?n.idx=n.chosen=parseInt(e):void 0},move:function(r){var o;return o=n.nodes[n.idx],o&&!n.ctrl&&(o.anchor[0]=r.offsetX,o.anchor[1]=r.offsetY,i()),o&&n.ctrl&&(o["ctrl"+n.ctrl][0]=r.offsetX-o.anchor[0],o["ctrl"+n.ctrl][1]=r.offsetY-o.anchor[1],i()),n.nodes.$save(n.idx)},mup:function(){return n.idx=null,n.ctrl=null},keydown:function(r){var o;return o=r.keyCode||r.which,8===o?(r.preventDefault(),n.remove()):void 0},keypress:function(){}},ldColorPicker.init(),n.color={setTarget:function(n){return this.target=n},fill:"none",stroke:"black"},$("#fillbtn")[0]._ldcpnode._ldcp.on("change",function(r){return console.log(n.color.target,r),n.$apply(function(){return n.color[n.color.target]=r})})}));